#!/usr/bin/python
# -*- coding: utf-8 -*-

'a test main'

__author__ = 'xusheng'

from sparktask import SparkTask

if __name__ == '__main__':
	#SparkTask().search("{\"query\":{\"range\":{\"device\":{\"gt\":1659916,\"lt\":1660000}}}}")	
	#SparkTask().search_person("{\"BODY\":{\"deviceIDList\":\"device\",\"beginTime\":111,\"endTime\":222}}")	
	if  SparkTask().spark_init():
		print(SparkTask().search_person('{"deviceUUIDList":"66","beginTime":1497456000000,"endTime":1498185608000, \
						  "searchRule":{ \
							"face":{"gender":[1,2],"age":[1,2,3,4],"hairStyle":[1,2,3],"isSpectacled":[1,2]}, \
						  	"body":{"upperBodyColor":"","lowerBodyColor":"","fullBodyColor":"","bodilyForm":[1,2],"height":[1,2,3]}, \
						  	"feature":{"type":1,"value":"-0.04501234115801811, 0.1649637566661234, 0.03652994707221234, 0.12103449553258888, -0.026508789509534836, -0.04054411128162222, -0.004706656094642345, -0.10440607368943434, -0.043456155401945114, -0.008930347859859467, 0.09987298399209976, -0.06774231791496277, 0.022658707574009895, -0.013907848857343197, -0.01851120963692665, -0.043588679283857346, 0.10100151598453522, 0.06126488745212555, -0.06315449625253677, -0.021078184247016907, 0.0023955421056598425, 0.03655077889561653, -0.04012903943657875, 0.03122691437602043, -0.12100300192832947, -0.0036196045111864805, -0.03203102946281433, 0.029596854001283646, 0.08771178126335144, -0.08097640424966812, -0.049361441284418106, -0.05042056366801262, 0.029287833720445633, -0.07727435976266861, -0.1006685197353363, -0.13803768157958984, -0.09149806946516037, -0.11296027898788452, 0.046647295355796814, 0.04320395737886429, 0.22887392342090607, -0.00706471037119627, 0.07915881276130676, -0.0038873159792274237, -0.15274299681186676, -0.19539079070091248, 0.01400281023234129, 0.0034911702387034893, -0.06039253622293472, 0.03174913674592972, 0.08468920737504959, -0.022023741155862808, 0.0311481524258852, 0.19627316296100616, -0.007201094646006823, 0.023531462997198105, 0.021591676399111748, -0.2295510172843933, 0.12935978174209595, 0.08364737033843994, -0.11128353327512741, -0.04200213402509689, -0.03775237500667572, -0.060171306133270264, -0.21693356335163116, -0.042944423854351044, 0.03473472595214844, -0.026259344071149826, 0.050973743200302124, -0.09711181372404099, -0.100657619535923, 0.10426848381757736, -0.101680226624012, 0.16586166620254517, -0.01795482262969017, -0.05156232416629791, 0.08337707817554474, 0.07370210438966751, -0.0481242835521698, -0.16336806118488312, -0.019672879949212074, 0.008744279853999615, -0.06019214913249016, 0.05195019766688347, 0.08042538911104202, -0.10334844887256622, -0.13802050054073334, 0.030922692269086838, 0.0140334852039814, 0.07960827648639679, 0.03900040686130524, -0.07453467696905136, -0.0012004115851595998, 0.018544737249612808, -0.20562328398227692, 0.0834846943616867, 0.06647080928087234, 0.0840158462524414, -0.07135537266731262, -0.06645998358726501, 0.006923649460077286, 0.12258011847734451, -0.10500368475914001, 0.07581568509340286, 0.000355873053194955, 0.13271278142929077, 0.0776800587773323, -0.07934650033712387, 0.130689799785614, 0.07616642862558365, 0.018351225182414055, 0.14911501109600067, 0.007672163192182779, -0.09699073433876038, -0.023278547450900078, -0.1295657753944397, -0.01966824382543564, 0.013113213703036308, -0.09740830957889557, 0.006485836114734411, -0.056692466139793396, 0.11100924760103226, 0.14266736805438995, -0.19488507509231567, 0.07439834624528885, -0.11404456561880112, 0.02985413186252117, -0.048643507063381234"}}}'))
	else:
		print('spark_init() error!')
